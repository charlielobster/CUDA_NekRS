
import numpy as np
import matplotlib.pyplot as plt

def bottomph(xin, xmin=0, xmax=252):
    xx = np.where(xin > xmax / 2, xin - xmax, xin)
    x = np.abs(xx)
    y = np.zeros_like(x)
    
    for i, xi in enumerate(x):
        if 0.0 <= xi <= 4.5:
            y[i] = 28.0
        elif 4.5 < xi <= 13.5:
            xi = xi - 4.5
            y[i] = min(28.0, 28.0 + 6.775070969851E-03*xi**2 - 2.124527775800E-03*xi**3)
        elif 13.5 < xi <= 18.5:
            xi = xi - 4.5
            y[i] = 2.507355893131e+01 + 9.754803562315e-01*xi - 1.016116352781e-01*xi**2 + 1.889794677828e-03*xi**3
        elif 18.5 < xi <= 24.5:
            xi = xi - 4.5
            y[i] = 2.579601052357e+01 + 8.206693007457e-01*xi - 9.055370274339e-02*xi**2 + 1.626510569859e-03*xi**3
        elif 24.5 < xi <= 34.5:
            xi = xi - 4.5
            y[i] = 4.046435022819e+01 - 1.379581654948e+00*xi + 1.945884504128e-02*xi**2 - 2.070318932190e-04*xi**3
        elif 34.5 < xi <= 44.5:
            xi = xi - 4.5
            y[i] = 1.792461334664E+01 + 8.743920332081E-01*xi - 5.567361123058e-02*xi**2 + 6.277731764683e-04*xi**3
        elif 44.5 < xi <= 58.5:
            xi = xi - 4.5
            y[i] = max(0.0, 5.639011190988e+01 - 2.010520359035e+00*xi + 1.644919857549e-02*xi**2 + 2.674976141766e-05*xi**3)
        elif 58.5 < xi <= 67.5:
            y[i] = 0
        elif 67.5 < xi <= 81.5:
            xi = 54.0 - (xi - 67.5)
            y[i] = 1.6 * max(0.0, 5.639011190988e+01 - 2.010520359035e+00*xi + 1.644919857549e-02*xi**2 + 2.674976141766e-05*xi**3)
        elif 81.5 < xi <= 91.5:
            xi = 40.0 - (xi - 81.5)
            y[i] = 1.6 * ( 1.792461334664E+01 + 8.743920332081E-01*xi - 5.567361123058e-02*xi**2 + 6.277731764683e-04*xi**3 )
        elif 91.5 < xi <= 101.5:
            xi = 30.0 - (xi - 91.5)
            y[i] = 1.6 * ( 4.046435022819e+01 - 1.379581654948e+00*xi + 1.945884504128e-02*xi**2 - 2.070318932190e-04*xi**3 )
        elif 101.5 < xi <= 107.5:
            xi = 20.0 - (xi - 101.5)
            y[i] = 1.6 * ( 2.579601052357e+01 + 8.206693007457e-01*xi - 9.055370274339e-02*xi**2 + 1.626510569859e-03*xi**3 )       
        elif 107.5 < xi <= 112.5:
            xi = 14.0 - (xi - 107.5)
            y[i] = 1.6 * ( 2.507355893131e+01 + 9.754803562315e-01*xi - 1.016116352781e-01*xi**2 + 1.889794677828e-03*xi**3 )      
        elif 112.5 < xi <= 121.5:
            xi = 9.0 - (xi - 112.5)
            y[i] = 1.6 * min(28.0, 28.0 + 6.775070969851E-03*xi**2 - 2.124527775800E-03*xi**3)
        elif 121.5 < xi <= 126.0:
            y[i] = 1.6 * 28.0

    return y

# Generate data and plot
xin = np.linspace(0, 252, 1000)
y = bottomph(xin)

plt.figure(figsize=(10, 5))
plt.plot(xin, y, label='bottomph(x)', color='blue')
plt.xlabel('xin')
plt.ylabel('bottomph(xin)')
plt.title('bottomph(xin) for xin âˆˆ [0, 252]')
plt.grid(True)
plt.legend()
plt.show()